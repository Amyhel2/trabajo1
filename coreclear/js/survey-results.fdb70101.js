"use strict";(self["webpackChunkcoreclear_portal"]=self["webpackChunkcoreclear_portal"]||[]).push([[802],{8786:(t,e,s)=>{s.r(e),s.d(e,{default:()=>z});var i=s(2202),a=s(7179),o=s(3385),n=s(6072),r=s(4437),l=s(6035),u=s(9841),c=s(9789),d=s(5057),h=s(248),p=s(1908),m=s(92),v=s(5294),g=s(2927),y=s(5234),f=s(5952),b=s(5838),C=s(2370),_=function(){var t=this,e=t._self._c;return e(l.Z,{staticClass:"py-10",attrs:{fluid:""}},[e(v.Z,{staticClass:"justify-center"},[e(r.Z,{attrs:{cols:"12",md:"10"}},[e(i.Z,{staticStyle:{position:"fixed",top:"20%",left:"50%",transform:"translate(-50%, -50%)","z-index":"9999","max-width":"35rem"},attrs:{type:t.alertType,border:"left","close-text":"Close Alert",elevation:"10",dismissible:"",transition:"scale-transition"},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[t._v(" "+t._s(t.alertMessage)+" ")]),e(o.Z,{staticClass:"rounded-lg pb-2"},[e(b.Z,{attrs:{color:"green",dark:""}},[e(C.qW,[t._v("Survey Responses")]),e(y.Z),e(a.Z,{staticClass:"white--text ml-2",attrs:{color:"green",fab:"",small:"",rounded:""},on:{click:t.openAddDialog}},[e(d.Z,[t._v(" mdi-plus ")])],1)],1),e(c.Z,{attrs:{fullscreen:this.$vuetify.breakpoint.smAndDown,"max-width":"800"},model:{value:t.addDialog,callback:function(e){t.addDialog=e},expression:"addDialog"}},[e(o.Z,{staticClass:"rounded-lg pb-2"},[e(b.Z,{attrs:{color:"green",dark:""}},[e(C.qW,[t._v(" Create Question ")])],1),e(l.Z,[e(v.Z,[e(r.Z,[e("p",[t._v("Question Type:")]),e(g.Z,{attrs:{items:t.questionTypeOptions,hint:t.selectHint},on:{input:t.showHint},model:{value:t.addItem.questionType,callback:function(e){t.$set(t.addItem,"questionType",e)},expression:"addItem.questionType"}})],1)],1),e(v.Z,[e(r.Z,[e("p",[t._v("Question Text:")]),e(f.Z,{model:{value:t.addItem.questionText,callback:function(e){t.$set(t.addItem,"questionText",e)},expression:"addItem.questionText"}})],1)],1),e(v.Z,[e(r.Z,[e("p",[t._v("Enabled:")]),e(n.Z,{attrs:{label:"Enable Question"},model:{value:t.addItem.enabled,callback:function(e){t.$set(t.addItem,"enabled",e)},expression:"addItem.enabled"}})],1)],1),e(v.Z,[e(a.Z,{staticClass:"ma-2",attrs:{color:"error"},on:{click:function(e){t.addDialog=!1}}},[t._v("Cancel")]),e(a.Z,{staticClass:"ma-2",attrs:{color:"success"},on:{click:t.createQuestion}},[t._v("Add")])],1)],1)],1)],1),e(c.Z,{attrs:{fullscreen:this.$vuetify.breakpoint.smAndDown,"max-width":"800"},model:{value:t.editDialog,callback:function(e){t.editDialog=e},expression:"editDialog"}},[e(o.Z,{staticClass:"rounded-lg pb-2"},[e(b.Z,{attrs:{color:"green",dark:""}},[e(C.qW,[t._v(" Edit Question ")])],1),e(l.Z,[e(v.Z,[e(r.Z,[e("p",[t._v("Question Type:")]),e(g.Z,{attrs:{items:t.questionTypeOptions,placeholder:t.editItem.questionType,hint:t.selectHint},on:{input:t.showHint},model:{value:t.editItem.questionType,callback:function(e){t.$set(t.editItem,"questionType",e)},expression:"editItem.questionType"}})],1)],1),e(v.Z,[e(r.Z,[e("p",[t._v("Question Text:")]),e(f.Z,{model:{value:t.editItem.questionText,callback:function(e){t.$set(t.editItem,"questionText",e)},expression:"editItem.questionText"}})],1)],1),e(v.Z,[e(r.Z,[e("p",[t._v("Enabled:")]),e(n.Z,{attrs:{label:"Enable Question"},model:{value:t.editItem.enabled,callback:function(e){t.$set(t.editItem,"enabled",e)},expression:"editItem.enabled"}})],1)],1),e(v.Z,[e(a.Z,{staticClass:"ma-2",attrs:{color:"error"},on:{click:function(e){t.editDialog=!1}}},[t._v("Cancel")]),e(a.Z,{staticClass:"ma-2",attrs:{color:"success"},on:{click:t.updateQuestion}},[t._v("Update")])],1)],1)],1)],1),[e(u.Z,{attrs:{headers:t.computedHeaders,items:t.surveyData,"items-per-page":5,loading:t.dataLoading,"loading-text":"Loading... Please wait","show-expand":"","single-expand":""},scopedSlots:t._u([{key:"item.responseRate",fn:function({item:e}){return[t._v(" "+t._s(t._f("percentage")(e.responseRate))+" ")]}},{key:"item.responseSummary",fn:function({item:s}){return[e("td",["yes_no"===s.questionType?e("yes-no-result-status",{attrs:{responseItem:s}}):"scaled"===s.questionType?e("scaled-result-status",{attrs:{responseItem:s}}):t._e()],1)]}},{key:"item.actions",fn:function({item:s}){return[e(m.Z,{attrs:{transition:"scroll-y-transition",bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[e(a.Z,t._g(t._b({attrs:{icon:""}},"v-btn",i,!1),s),[e(d.Z,[t._v(" mdi-dots-vertical ")])],1)]}}],null,!0)},[e(h.Z,[e(p.Z,[e(a.Z,{attrs:{color:"warning",text:""},on:{click:function(e){return t.openEditDialog(s)}}},[e(d.Z,{attrs:{small:"",left:""}},[t._v(" mdi-pencil ")]),t._v(" Edit ")],1)],1),e(p.Z,[e(a.Z,{attrs:{color:"error",text:""},on:{click:function(e){return t.deleteQuestion(s)}}},[e(d.Z,{attrs:{small:"",left:""}},[t._v(" mdi-delete ")]),t._v(" Delete ")],1)],1)],1)],1)]}},{key:"no-data",fn:function(){return[e(i.Z,{staticClass:"ma-2",attrs:{prominent:"",text:"",type:"info"}},[e(v.Z,{attrs:{align:"center"}},[e(r.Z,{staticClass:"grow"},[t._v(" No records found ")]),e(r.Z,{staticClass:"shrink"},[e(a.Z,{staticClass:"my-2 white--text",attrs:{color:"green"},on:{click:t.initialize}},[t._v(" Retry ")])],1)],1)],1)]},proxy:!0},{key:"expanded-item",fn:function({item:s}){return[e("td",{attrs:{colspan:100}},[e("div",{staticClass:"mx-15 my-2"},[e(u.Z,{attrs:{items:s.responses,headers:t.responseHeaders,"hide-default-footer":""}})],1)])]}}],null,!0)})]],2)],1)],1)],1)},Z=[],x=(s(7658),s(9669)),I=s.n(x),T=s(629),k=s(1302),q=s(3432),D=function(){var t=this,e=t._self._c;return e("div",[e(q.Z,{attrs:{color:t.color,bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[e(k.Z,t._g(t._b({attrs:{color:t.color,value:t.formattedAverageResponse,height:"6"}},"v-progress-linear",i,!1),s))]}}])},[e("span",[t._v(t._s(t.message))])]),e("div",[t._v(t._s(t.averageResponse))])],1)},w=[],S={name:"ScaledResultStatus",props:{responseItem:{type:Object,required:!0,default:()=>({})}},data(){return{responseSummary:null}},mounted(){},computed:{color(){return this.averageResponse>=3.5?"success":"error"},message(){return this.averageResponse?this.averageResponse:"No Responses"},averageResponse(){let t=0;this.responseItem.responses.forEach((e=>{t+=e.answerKey*e.responseCount}));const e=t/this.responseItem.responseCount,s=e.toFixed(2);return console.log(s),isNaN(s)?"No Responses":s},formattedAverageResponse(){return 20*this.averageResponse}}},A=S,R=s(1001),$=(0,R.Z)(A,D,w,!1,null,null,null),V=$.exports,Q=function(){var t=this,e=t._self._c;return e("div",[e(q.Z,{attrs:{color:t.color,bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[e(k.Z,t._g(t._b({attrs:{color:t.color,value:t.averageResponse,height:"6"}},"v-progress-linear",i,!1),s))]}}])},[e("span",[t._v(t._s(t.message))])]),e("div",[t._v(t._s(t.average))])],1)},E=[],L={name:"YesNoResultStatus",props:{responseItem:{type:Object,required:!0,default:()=>({})}},data(){return{responseSummary:null}},computed:{color(){return this.averageResponse>=50?"success":"error"},message(){return this.averageResponse?this.averageResponse+"% yes":"No Responses"},average(){return this.averageResponse?this.averageResponse+"% yes":"No Responses"},averageResponse(){const t=this.responseItem.responses[1].responseCount/this.responseItem.responseCount*100;return isNaN(t)?(console.log("bad"),null):t.toFixed(0)}}},O=L,N=(0,R.Z)(O,Q,E,!1,null,null,null),F=N.exports,B={name:"SurveyResultsList",components:{YesNoResultStatus:F,ScaledResultStatus:V},data(){return{results:!1,scaled:!1,surveyData:[],dataLoading:!1,addDialog:!1,editDialog:!1,addItem:{questionText:"",questionType:"",enabled:!1},editItem:{id:"",questionText:"",questionType:"",enabled:!1},alert:!1,alertMessage:"",alertType:"success",submitButton:"",selectHint:"",questionType:"",questionTypeOptions:["Scaled","Yes or no"],responseHeaders:[{text:"Response Options",value:"answerDescription",sortable:!1},{text:"Amount",value:"responseCount",sortable:!1}]}},computed:{...(0,T.Se)(["getInternalCoreClearController"]),computedHeaders(){return[{text:"Question",align:"start",sortable:!0,value:"questionText"},{text:"Number of Responses",value:"responseCount"},{text:"Response Rate",value:"responseRate"},{text:"Total Transaction Count",value:"transactionCount"},{text:"Response Summary",value:"responseSummary"},{text:"Actions",value:"actions",sortable:!1}]}},mounted(){this.initialize()},methods:{initialize(){this.getData()},async getData(){this.dataLoading=!0;try{let t=await I().get(`${this.getInternalCoreClearController}/survey_questions`,{withCredentials:!0,crossDomain:!0});!0===t.data.success?(console.log(t.data),await Promise.all(t.data.results.map((async t=>{try{let e=await I().get(`${this.getInternalCoreClearController}/survey_results`,{withCredentials:!0,crossDomain:!0,params:{question_id:t.id}});e.data&&this.surveyData.push(e.data)}catch(e){console.error("Could not get survey questions"),console.error(e)}})))):console.log("could not get data"),this.dataLoading=!1}catch(t){console.error("Could not get survey questions"),console.error(t)}},async getQuestionDetail(t){this.dataLoading=!0;try{let e=await I().get(`${this.getInternalCoreClearController}/survey_question`,{withCredentials:!0,crossDomain:!0,params:{question_id:t.id}});e.data&&(this.editItem=e.data),this.dataLoading=!1}catch(e){console.error("Could not get survey questions"),console.error(e)}},openAddDialog(){this.addItem={questionText:"",questionType:"",enabled:!1},this.addDialog=!0},async openEditDialog(t){await this.getQuestionDetail(t),"scaled"==t.questionType?this.editItem.questionType="Scaled":"yes_no"==t.questionType&&(this.editItem.questionType="Yes or no"),this.editDialog=!0},async createQuestion(){let t=new FormData;t.append("question_type",this.formatQuestionType(this.addItem.questionType)),t.append("question_text",this.addItem.questionText),t.append("enabled",this.formatEnabledValue(this.addItem.enabled));try{let e=await I().post(`${this.getInternalCoreClearController}/update_survey_question`,t,{withCredentials:!0,crossDomain:!0});!0===e.data.success?(this.alert=!0,this.alertMessage="Question Created",this.alertType="success",setTimeout((()=>{location.reload()}),1500)):(console.log("problem occured"),this.alert=!0,this.alertMessage="A Problem Occured",this.alertType="error")}catch(e){console.error("Could not update survey questions"),console.error(e)}},async updateQuestion(){let t=new FormData;t.append("question_id",this.editItem.id),t.append("question_type",this.formatQuestionType(this.editItem.questionType)),t.append("question_text",this.editItem.questionText),t.append("enabled",this.formatEnabledValue(this.editItem.enabled));try{let e=await I().post(`${this.getInternalCoreClearController}/update_survey_question`,t,{withCredentials:!0,crossDomain:!0});!0===e.data.success?(this.alert=!0,this.alertMessage="Question Updated",this.alertType="success",setTimeout((()=>{location.reload()}),1500)):(console.log("problem occured"),this.alert=!0,this.alertMessage="A Problem Occured",this.alertType="error")}catch(e){console.error("Could not update survey questions"),console.error(e)}},async deleteQuestion(t){let e=new FormData;e.append("question_id",t.id);try{let t=await I().post(`${this.getInternalCoreClearController}/delete_survey_question`,e,{withCredentials:!0,crossDomain:!0});!0===t.data.success?(this.alert=!0,this.alertMessage="Question Deleted",this.alertType="success",setTimeout((()=>{location.reload()}),1500)):(console.log("problem occured"),this.alert=!0,this.alertMessage="A Problem Occured",this.alertType="error")}catch(s){console.error("Could not delete survey questions"),console.error(s)}},showHint(t){"Yes or no"==t?this.selectHint="Requires a binary yes or no response":"Scaled"==t&&(this.selectHint="Provides a 5 point scale as a rating method")},formatEnabledValue(t){let e=0;return!1===t?e=0:!0===t?e=1:console.log("problem"),e},formatQuestionType(t){return"Yes or no"==t?"yes_no":"Scaled"==t?"scaled":void 0}},filters:{percentage:t=>t?(100*t).toFixed(2)+"%":"0%"}},H=B,M=(0,R.Z)(H,_,Z,!1,null,null,null),z=M.exports},5447:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var i=s(6035),a=function(){var t=this,e=t._self._c;return e(i.Z,{staticClass:"p-10",attrs:{fluid:""}},[e("router-view")],1)},o=[],n={name:"SurveyResultsScreen"},r=n,l=s(1001),u=(0,l.Z)(r,a,o,!1,null,null,null),c=u.exports},6072:(t,e,s)=>{s.d(e,{Z:()=>n});s(7393);var i=s(1012),a=s(3316),o=s(1465),n=o.Z.extend({name:"v-checkbox",props:{indeterminate:Boolean,indeterminateIcon:{type:String,default:"$checkboxIndeterminate"},offIcon:{type:String,default:"$checkboxOff"},onIcon:{type:String,default:"$checkboxOn"}},data(){return{inputIndeterminate:this.indeterminate}},computed:{classes(){return{...a.Z.options.computed.classes.call(this),"v-input--selection-controls":!0,"v-input--checkbox":!0,"v-input--indeterminate":this.inputIndeterminate}},computedIcon(){return this.inputIndeterminate?this.indeterminateIcon:this.isActive?this.onIcon:this.offIcon},validationState(){if(!this.isDisabled||this.inputIndeterminate)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":null!==this.hasColor?this.computedColor:void 0}},watch:{indeterminate(t){this.$nextTick((()=>this.inputIndeterminate=t))},inputIndeterminate(t){this.$emit("update:indeterminate",t)},isActive(){this.indeterminate&&(this.inputIndeterminate=!1)}},methods:{genCheckbox(){const{title:t,...e}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(i.Z,this.setTextColor(this.validationState,{props:{dense:this.dense,dark:this.dark,light:this.light}}),this.computedIcon),this.genInput("checkbox",{...e,"aria-checked":this.inputIndeterminate?"mixed":this.isActive.toString()}),this.genRipple(this.setTextColor(this.rippleState))])},genDefaultSlot(){return[this.genCheckbox(),this.genLabel()]}}})},3432:(t,e,s)=>{s.d(e,{Z:()=>d});var i=s(5840),a=s(8914),o=s(4019),n=s(2524),r=s(7482),l=s(1050),u=s(6596),c=s(4987),d=(0,c.Z)(a.Z,o.Z,n.Z,r.Z).extend({name:"v-tooltip",props:{closeDelay:{type:[Number,String],default:0},disabled:Boolean,openDelay:{type:[Number,String],default:0},openOnHover:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!0},tag:{type:String,default:"span"},transition:String},data:()=>({calculatedMinWidth:0,closeDependents:!1}),computed:{calculatedLeft(){const{activator:t,content:e}=this.dimensions,s=!this.bottom&&!this.left&&!this.top&&!this.right,i=!1!==this.attach?t.offsetLeft:t.left;let a=0;return this.top||this.bottom||s?a=i+t.width/2-e.width/2:(this.left||this.right)&&(a=i+(this.right?t.width:-e.width)+(this.right?10:-10)),this.nudgeLeft&&(a-=parseInt(this.nudgeLeft)),this.nudgeRight&&(a+=parseInt(this.nudgeRight)),`${this.calcXOverflow(a,this.dimensions.content.width)}px`},calculatedTop(){const{activator:t,content:e}=this.dimensions,s=!1!==this.attach?t.offsetTop:t.top;let i=0;return this.top||this.bottom?i=s+(this.bottom?t.height:-e.height)+(this.bottom?10:-10):(this.left||this.right)&&(i=s+t.height/2-e.height/2),this.nudgeTop&&(i-=parseInt(this.nudgeTop)),this.nudgeBottom&&(i+=parseInt(this.nudgeBottom)),!1===this.attach&&(i+=this.pageYOffset),`${this.calcYOverflow(i)}px`},classes(){return{"v-tooltip--top":this.top,"v-tooltip--right":this.right,"v-tooltip--bottom":this.bottom,"v-tooltip--left":this.left,"v-tooltip--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},computedTransition(){return this.transition?this.transition:this.isActive?"scale-transition":"fade-transition"},offsetY(){return this.top||this.bottom},offsetX(){return this.left||this.right},styles(){return{left:this.calculatedLeft,maxWidth:(0,l.kb)(this.maxWidth),minWidth:(0,l.kb)(this.minWidth),top:this.calculatedTop,zIndex:this.zIndex||this.activeZIndex}}},beforeMount(){this.$nextTick((()=>{this.value&&this.callActivate()}))},mounted(){"v-slot"===(0,l.sp)(this,"activator",!0)&&(0,u.N6)("v-tooltip's activator slot must be bound, try '<template #activator=\"data\"><v-btn v-on=\"data.on>'",this)},methods:{activate(){this.updateDimensions(),requestAnimationFrame(this.startTransition)},deactivate(){this.runDelay("close")},genActivatorListeners(){const t=i.Z.options.methods.genActivatorListeners.call(this);return this.openOnFocus&&(t.focus=t=>{this.getActivator(t),this.runDelay("open")},t.blur=t=>{this.getActivator(t),this.runDelay("close")}),t.keydown=t=>{t.keyCode===l.Do.esc&&(this.getActivator(t),this.runDelay("close"))},t},genActivatorAttributes(){return{"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genTransition(){const t=this.genContent();return this.computedTransition?this.$createElement("transition",{props:{name:this.computedTransition}},[t]):t},genContent(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-tooltip__content",class:{[this.contentClass]:!0,menuable__content__active:this.isActive,"v-tooltip__content--fixed":this.activatorFixed},style:this.styles,attrs:this.getScopeIdAttrs(),directives:[{name:"show",value:this.isContentActive}],ref:"content"}),this.getContentSlot())}},render(t){return t(this.tag,{staticClass:"v-tooltip",class:this.classes},[this.showLazyContent((()=>[this.genTransition()])),this.genActivator()])}})},1465:(t,e,s)=>{s.d(e,{Z:()=>c});s(7658);var i=s(3316),a=s(3176),o=s(144),n=o.ZP.extend({name:"rippleable",directives:{ripple:a.Z},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple(t={}){return this.ripple?(t.staticClass="v-input--selection-controls__ripple",t.directives=t.directives||[],t.directives.push({name:"ripple",value:{center:!0}}),this.$createElement("div",t)):null}}}),r=s(564),l=s(4987);function u(t){t.preventDefault()}var c=(0,l.Z)(i.Z,n,r.Z).extend({name:"selectable",model:{prop:"inputValue",event:"change"},props:{id:String,inputValue:null,falseValue:null,trueValue:null,multiple:{type:Boolean,default:null},label:String},data(){return{hasColor:this.inputValue,lazyValue:this.inputValue}},computed:{computedColor(){if(this.isActive)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},isMultiple(){return!0===this.multiple||null===this.multiple&&Array.isArray(this.internalValue)},isActive(){const t=this.value,e=this.internalValue;return this.isMultiple?!!Array.isArray(e)&&e.some((e=>this.valueComparator(e,t))):void 0===this.trueValue||void 0===this.falseValue?t?this.valueComparator(t,e):Boolean(e):this.valueComparator(e,this.trueValue)},isDirty(){return this.isActive},rippleState(){return this.isDisabled||this.validationState?this.validationState:void 0}},watch:{inputValue(t){this.lazyValue=t,this.hasColor=t}},methods:{genLabel(){const t=i.Z.options.methods.genLabel.call(this);return t?(t.data.on={click:u},t):t},genInput(t,e){return this.$createElement("input",{attrs:Object.assign({"aria-checked":this.isActive.toString(),disabled:this.isDisabled,id:this.computedId,role:t,type:t},e),domProps:{value:this.value,checked:this.isActive},on:{blur:this.onBlur,change:this.onChange,focus:this.onFocus,keydown:this.onKeydown,click:u},ref:"input"})},onClick(t){this.onChange(),this.$emit("click",t)},onChange(){if(!this.isInteractive)return;const t=this.value;let e=this.internalValue;if(this.isMultiple){Array.isArray(e)||(e=[]);const s=e.length;e=e.filter((e=>!this.valueComparator(e,t))),e.length===s&&e.push(t)}else e=void 0!==this.trueValue&&void 0!==this.falseValue?this.valueComparator(e,this.trueValue)?this.falseValue:this.trueValue:t?this.valueComparator(e,t)?null:t:!e;this.validate(!0,e),this.internalValue=e,this.hasColor=e},onFocus(t){this.isFocused=!0,this.$emit("focus",t)},onBlur(t){this.isFocused=!1,this.$emit("blur",t)},onKeydown(t){}}})},7393:()=>{}}]);
//# sourceMappingURL=survey-results.fdb70101.js.map