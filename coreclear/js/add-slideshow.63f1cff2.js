"use strict";(self["webpackChunkcoreclear_portal"]=self["webpackChunkcoreclear_portal"]||[]).push([[721],{6834:(e,a,t)=>{t.r(a),t.d(a,{default:()=>F});var s=t(2202),l=t(7179),i=t(3385),o=t(5223),r=t(4437),n=t(6035),d=t(271),c=t(2469),g=t(3823),p=t(5294),u=t(5234),m=t(5952),h=t(5838),C=t(2370),b=function(){var e=this,a=e._self._c;return a(n.Z,{staticClass:"py-10",attrs:{fluid:""}},[a(s.Z,{staticStyle:{position:"fixed",top:"20%",left:"50%",transform:"translate(-50%, -50%)","z-index":"9999","max-width":"35rem"},attrs:{type:e.alertType,border:"left","close-text":"Close Alert",elevation:"10",transition:"scale-transition"},model:{value:e.alert,callback:function(a){e.alert=a},expression:"alert"}},[e._v(" "+e._s(e.alertMessage)+" ")]),a(p.Z,{attrs:{justify:"center"}},[a(r.Z,{attrs:{cols:"12",md:"6"}},[a(i.Z,{staticClass:"rounded-lg pb-2"},[a(h.Z,{attrs:{color:"green",dark:"",flat:""}},[a(C.qW,[e._v(" Add Slideshow ")])],1),a(o.ZB,[a(p.Z,[a(r.Z,{staticClass:"pb-0",attrs:{cols:"12",md:"6"}},[a(m.Z,{attrs:{label:"Slideshow Name","hide-details":"auto","background-color":"white",solo:""},model:{value:e.name,callback:function(a){e.name=a},expression:"name"}})],1),a(r.Z,{staticClass:"pb-0",attrs:{cols:"12",md:"6"}},[a(m.Z,{attrs:{label:"Slideshow Time","hide-details":"auto",suffix:"seconds",solo:""},model:{value:e.delay,callback:function(a){e.delay=a},expression:"delay"}})],1)],1),a(n.Z,{staticClass:"my-4"},[a("draggable",{staticClass:"row",attrs:{group:"imageGroup"},model:{value:e.slides,callback:function(a){e.slides=a},expression:"slides"}},[0==e.slides.length?a("p",{staticClass:"mt-6"},[e._v(" Drag images here, or upload an image ")]):e._l(e.slides,(function(t){return a(r.Z,{key:t.id,attrs:{cols:"3"}},[a(i.Z,[a(o.ZB,[a(c.Z,{attrs:{contain:"",src:t.thumbnailUrl}})],1),a(o.h7,[a(l.Z,{attrs:{color:"warning"},on:{click:function(a){return e.removeSlide(t)}}},[e._v(" Delete ")])],1)],1)],1)}))],2)],1)],1),a(o.h7,{staticClass:"pt-3 pb-0"},[a(l.Z,{attrs:{color:"error",to:"/terminals/slideshows"}},[e._v(" Cancel ")]),a(u.Z),a(l.Z,{attrs:{color:"success"},on:{click:function(a){return e.addSlideshow()}}},[e._v(" Add ")])],1)],1)],1),a(r.Z,{attrs:{cols:"12",md:"6"}},[a(i.Z,{staticClass:"rounded-lg pb-2"},[a(h.Z,{attrs:{color:"green",dark:"",flat:""}},[a(C.qW,[e._v(" Image Library ")])],1),a(o.EB,{staticClass:"justify-center pt-2 pb-0 black--text"},[e._v(" Upload an Image ")]),a(d.Z,{staticClass:"px-5",attrs:{chips:"",counter:"","show-size":"","truncate-length":"50",accept:"image/*",label:"Choose File",hint:"Recommended dimensions: 840 x 480","persistent-hint":""},model:{value:e.originalFile,callback:function(a){e.originalFile=a},expression:"originalFile"}}),a(o.Qq,{staticClass:"pt-0 pb-1 text-center"},[e._v(" Upload png, jpg, gif ")]),a(l.Z,{staticClass:"justify-center",staticStyle:{display:"block",margin:"0 auto 1rem"},attrs:{right:""},on:{click:e.uploadMedia}},[e._v(" Upload ")]),a("draggable",{staticClass:"row",attrs:{group:{name:"imageGroup",pull:"clone",put:"false"}},model:{value:e.images,callback:function(a){e.images=a},expression:"images"}},e._l(e.images,(function(e){return a(r.Z,{key:e.id,attrs:{cols:"3"}},[a(i.Z,[a(c.Z,{attrs:{src:e.thumbnailUrl,"min-width":"120"}})],1)],1)})),1),a(g.Z,{staticClass:"mt-6",attrs:{circle:"",length:e.pagesTotal,"total-visible":7},on:{input:e.getMediaLibrary},model:{value:e.page,callback:function(a){e.page=a},expression:"page"}})],1)],1)],1)],1)},f=[],y=(t(7658),t(9669)),w=t.n(y),Z=t(9980),v=t.n(Z),_=t(629),k={name:"AddSlideshowScreen",components:{draggable:v()},data(){return{pagesTotal:1,alert:!1,alertMessage:"",alertType:"error",images:[],page:1,name:"",delay:"",slides:[],newImage:[],originalFile:null}},mounted(){this.getMediaLibrary()},computed:{...(0,_.Se)(["getInternalCoreClearController"])},methods:{async getMediaLibrary(e){try{let a=await w().get(""+(this.getInternalCoreClearController+"/get_media"),{params:{page:e},withCredentials:!0,crossDomain:!0});a.data?(this.pagesTotal=a.data.pages,console.log(a.data),this.images=a.data.results):(this.images=[],console.log("Media library not found!"))}catch(a){console.error("Could not get media library"),console.error(a)}},async addSlideshow(){let e=new FormData;e.append("name",this.name),e.append("delay",this.delay),this.slides.forEach((a=>{e.append("slides[]",JSON.stringify(a))}));try{let a=await w().post(""+(this.getInternalCoreClearController+"/update_slide_show"),e,{withCredentials:!0,crossDomain:!0});!0===a.data.success?(console.log("Post"),console.log(a),this.alert=!0,this.alertType="success",this.alertMessage="Slideshow added",setTimeout((()=>{this.$router.push("/terminals/slideshows")}),1500)):console.log("Media library not found!")}catch(a){console.error("Could not upload media"),console.error(a)}},async uploadMedia(){console.log(this.originalFile);let e=new FormData;e.append("upload_media",this.originalFile,this.originalFile.name);try{let a=await w().post(""+(this.getInternalCoreClearController+"/upload_media"),e,{withCredentials:!0,crossDomain:!0,headers:{"Content-Type":"multipart/form-data"}});a.data?this.getMediaAsset(a.data.id):console.log("Media library not found!")}catch(a){console.error("Could not upload media"),console.error(a)}this.reset()},async getMediaAsset(e){try{let a=await w().get(""+(this.getInternalCoreClearController+"/get_media_asset"),{params:{media_id:e},withCredentials:!0,crossDomain:!0});a.data?(console.log(a.data),this.newImage={description:a.data.description||"",fileUrl:a.data.fileUrl,id:a.data.id,name:a.data.name||"",originalFile:a.data.originalFile,tags:a.data.tags||null,thumbnailUrl:a.data.thumbnailUrl,video:a.data.video||!1},this.slides.push(this.newImage)):console.log("Media asset not found!")}catch(a){console.error("Could not get media library"),console.error(a)}},removeSlide(e){const a=e.id,t=this.slides.findIndex((e=>e.id===a));-1!==t&&this.slides.splice(t,1)}}},x=k,M=t(1001),S=(0,M.Z)(x,b,f,!1,null,null,null),F=S.exports}}]);
//# sourceMappingURL=add-slideshow.63f1cff2.js.map