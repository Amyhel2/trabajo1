"use strict";(self["webpackChunkcoreclear_portal"]=self["webpackChunkcoreclear_portal"]||[]).push([[535],{7944:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});var r=s(2202),o=s(8819),a=s(7179),n=s(3385),l=s(5223),i=s(4437),d=s(6035),c=s(9789),p=s(3422),u=s(6904),m=s(2469),g=s(1302),h=s(5294),w=s(5234),v=s(5952),y=s(5838),f=s(2370),C=function(){var e=this,t=e._self._c;return t(d.Z,{staticClass:"fill-height",attrs:{fluid:""}},[t(h.Z,{staticClass:"align-center justify-center"},[t(i.Z,{attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[t(r.Z,{attrs:{border:"left","close-text":"Close Alert",type:e.alertType,transition:"scale-transition",prominent:""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v(" "+e._s(e.alertMessage)+" ")]),t(p.Z5,[t(n.Z,{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"elevation-12 rounded-lg"},[t(y.Z,{attrs:{color:e.getAppColors.primary,dark:""}},[t(o.Z,{attrs:{size:"50px"}},[t(m.Z,{attrs:{alt:"Logo",src:s(9344),contain:""}})],1),t(f.qW,{attrs:{dark:""}},[e._v(" core"),t("strong",[e._v("CLEAR")]),e._v(" Portal ")])],1),t(l.ZB,[t(u.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(v.Z,{attrs:{"prepend-icon":"person",color:e.getAppColors.primary,label:"Username",name:"username",type:"text",autocomplete:"username",rules:e.usernameRules,required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t(v.Z,{attrs:{"prepend-icon":"lock",color:e.getAppColors.primary,"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",label:"Password",name:"password",type:e.showPassword?"text":"password",autocomplete:"current-password",rules:e.passwordRules,required:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)},"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),t(l.h7,[t(a.Z,{attrs:{color:e.getAppColors.primary,text:"",rounded:"",large:"",to:"/forgot-password"}},[e._v(" Forgot Password? ")]),t(w.Z),t(a.Z,{staticClass:"white--text",attrs:{color:e.getAppColors.primary,disabled:!e.valid,loading:e.loading,rounded:"",large:""},on:{click:e.submit}},[e._v(" Login ")])],1)],1)],1),t(c.Z,{attrs:{"hide-overlay":"",persistent:"",transition:"dialog-bottom-transition",width:"300"},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[t(n.Z,{attrs:{color:e.getAppColors.primary,dark:""}},[t(l.ZB,[e._v(" Logging in... "),t(g.Z,{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)],1)],1)},Z=[],k=(s(7658),s(9669)),b=s.n(k),L=s(629),A={name:"LoginScreen",data(){return{loading:!1,valid:!1,showPassword:!1,alert:!1,alertMessage:"",alertType:"success",username:"",password:"",usernameRules:[e=>!!e||"Username is required"],passwordRules:[e=>!!e||"Password is required"]}},computed:{...(0,L.Se)(["getAppColors","getInternalLoginController"]),subdomain(){let e=window.location.host,t=e.split(".");return t[0]}},methods:{openAlert(e,t){this.alertType=e,this.alertMessage=t,this.alert=!0},submit(){this.$refs.form.validate()&&(this.loading=!0,this.alert=!1,this.userLogin())},async userLogin(){let e=new FormData;e.append("username",this.username),e.append("password",this.password);try{let t=await b().post(""+(this.getInternalLoginController+"/auth_only"),e,{withCredentials:!0,crossDomain:!0});this.loading=!1,!0===t.data.success?(console.log("Logged in!"),this.$store.commit("setIsAuthenticated",!0),this.$store.commit("setCurrentLocationId",t.data.currentLocationId),this.$store.commit("setCurrentLocationName",t.data.currentLocationName),this.$store.commit("setAuthenticatedLocations",t.data.authenticatedLocations),this.$router.push("/")):this.openAlert("error",t.data.error_message)}catch(t){console.error("Could not login"),console.error(t),this.$store.commit("setIsAuthenticated",!1),this.openAlert("error",t.toString()),this.loading=!1}}}},_=A,x=s(1001),P=(0,x.Z)(_,C,Z,!1,null,null,null),$=P.exports}}]);
//# sourceMappingURL=login.090f36aa.js.map