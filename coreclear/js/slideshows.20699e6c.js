"use strict";(self["webpackChunkcoreclear_portal"]=self["webpackChunkcoreclear_portal"]||[]).push([[772],{4018:(e,t,s)=>{s.r(t),s.d(t,{default:()=>X});var a=s(2202),i=s(7179),o=s(3385),l=s(5223),n=s(4437),r=s(6035),d=s(9841),c=s(9789),h=s(4791),p=s(380),u=s(1050),g=s(4987),m=(0,g.Z)((0,h.d)("expansionPanels","v-expansion-panel","v-expansion-panels"),(0,p.J)("expansionPanel",!0)).extend({name:"v-expansion-panel",props:{disabled:Boolean,readonly:Boolean},data(){return{content:null,header:null,nextIsActive:!1}},computed:{classes(){return{"v-expansion-panel--active":this.isActive,"v-expansion-panel--next-active":this.nextIsActive,"v-expansion-panel--disabled":this.isDisabled,...this.groupClasses}},isDisabled(){return this.expansionPanels.disabled||this.disabled},isReadonly(){return this.expansionPanels.readonly||this.readonly}},methods:{registerContent(e){this.content=e},unregisterContent(){this.content=null},registerHeader(e){this.header=e,e.$on("click",this.onClick)},unregisterHeader(){this.header=null},onClick(e){e.detail&&this.header.$el.blur(),this.$emit("click",e),this.isReadonly||this.isDisabled||this.toggle()},toggle(){this.$nextTick((()=>this.$emit("change")))}},render(e){return e("div",{staticClass:"v-expansion-panel",class:this.classes,attrs:{"aria-expanded":String(this.isActive)}},(0,u.z9)(this))}}),v=s(3422),w=s(7601),f=s(8914);const x=(0,g.Z)(w.Z,f.Z,(0,p.f)("expansionPanel","v-expansion-panel-content","v-expansion-panel"));var C=x.extend().extend({name:"v-expansion-panel-content",data:()=>({isActive:!1}),computed:{parentIsActive(){return this.expansionPanel.isActive}},watch:{parentIsActive:{immediate:!0,handler(e,t){e&&(this.isBooted=!0),null==t?this.isActive=e:this.$nextTick((()=>this.isActive=e))}}},created(){this.expansionPanel.registerContent(this)},beforeDestroy(){this.expansionPanel.unregisterContent()},render(e){return e(v.Fx,this.showLazyContent((()=>[e("div",this.setBackgroundColor(this.color,{staticClass:"v-expansion-panel-content",directives:[{name:"show",value:this.isActive}]}),[e("div",{class:"v-expansion-panel-content__wrap"},(0,u.z9)(this,"default",{open:this.isActive}))])])))}}),y=s(1012),b=s(3176);const _=(0,g.Z)(f.Z,(0,p.f)("expansionPanel","v-expansion-panel-header","v-expansion-panel"));var Z=_.extend().extend({name:"v-expansion-panel-header",directives:{ripple:b.Z},props:{disableIconRotate:Boolean,expandIcon:{type:String,default:"$expand"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1}},data:()=>({hasMousedown:!1}),computed:{classes(){return{"v-expansion-panel-header--active":this.isActive,"v-expansion-panel-header--mousedown":this.hasMousedown}},isActive(){return this.expansionPanel.isActive},isDisabled(){return this.expansionPanel.isDisabled},isReadonly(){return this.expansionPanel.isReadonly}},created(){this.expansionPanel.registerHeader(this)},beforeDestroy(){this.expansionPanel.unregisterHeader()},methods:{onClick(e){this.$emit("click",e)},genIcon(){const e=(0,u.z9)(this,"actions",{open:this.isActive})||[this.$createElement(y.Z,this.expandIcon)];return this.$createElement(v.Z5,[this.$createElement("div",{staticClass:"v-expansion-panel-header__icon",class:{"v-expansion-panel-header__icon--disable-rotate":this.disableIconRotate},directives:[{name:"show",value:!this.isDisabled}]},e)])}},render(e){return e("button",this.setBackgroundColor(this.color,{staticClass:"v-expansion-panel-header",class:this.classes,attrs:{tabindex:this.isDisabled?-1:null,type:"button","aria-expanded":this.isActive},directives:[{name:"ripple",value:this.ripple}],on:{...this.$listeners,click:this.onClick,mousedown:()=>this.hasMousedown=!0,mouseup:()=>this.hasMousedown=!1}}),[(0,u.z9)(this,"default",{open:this.isActive},!0),this.hideActions||this.genIcon()])}}),k=s(2021),B=s(6596),A=k.y.extend({name:"v-expansion-panels",provide(){return{expansionPanels:this}},props:{accordion:Boolean,disabled:Boolean,flat:Boolean,hover:Boolean,focusable:Boolean,inset:Boolean,popout:Boolean,readonly:Boolean,tile:Boolean},computed:{classes(){return{...k.y.options.computed.classes.call(this),"v-expansion-panels":!0,"v-expansion-panels--accordion":this.accordion,"v-expansion-panels--flat":this.flat,"v-expansion-panels--hover":this.hover,"v-expansion-panels--focusable":this.focusable,"v-expansion-panels--inset":this.inset,"v-expansion-panels--popout":this.popout,"v-expansion-panels--tile":this.tile}}},created(){this.$attrs.hasOwnProperty("expand")&&(0,B.fK)("expand","multiple",this),Array.isArray(this.value)&&this.value.length>0&&"boolean"===typeof this.value[0]&&(0,B.fK)(':value="[true, false, true]"',':value="[0, 2]"',this)},methods:{updateItem(e,t){const s=this.getValue(e,t),a=this.getValue(e,t+1);e.isActive=this.toggleMethod(s),e.nextIsActive=this.toggleMethod(a)}}}),I=s(271),D=s(6904),S=s(5057),$=s(2469),M=s(248),P=s(1908),T=s(92),z=s(3823),V=s(5294),E=s(5234),F=s(5952),U=s(5838),L=s(2370),R=function(){var e=this,t=e._self._c;return t(r.Z,{staticClass:"py-10",attrs:{fluid:""}},[t(a.Z,{staticStyle:{position:"fixed",top:"20%",left:"50%",transform:"translate(-50%, -50%)","z-index":"9999","max-width":"35rem"},attrs:{type:e.alertType,border:"left","close-text":"Close Alert",elevation:"10",transition:"scale-transition"},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v(" "+e._s(e.alertMessage)+" ")]),t(c.Z,{staticClass:"rounded-lg",attrs:{fullscreen:"",transition:"dialog-bottom-transition"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(r.Z,[t(o.Z,{staticClass:"rounded-lg"},[t(U.Z,{attrs:{color:"green",dark:"",flat:"","mt-4":""}},[t(L.qW,[e._v(" Update Slideshow ")])],1),t(l.ZB,[t(V.Z,[t(n.Z,{staticClass:"pb-0",attrs:{cols:"12",md:"6"}},[t(F.Z,{attrs:{label:e.slideshow.name,"hide-details":"auto","background-color":"white",solo:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),t(n.Z,{staticClass:"pb-0",attrs:{cols:"12",md:"6"}},[t(F.Z,{attrs:{label:e.slideshow.delay,"hide-details":"auto",suffix:"seconds",solo:""},model:{value:e.delay,callback:function(t){e.delay=t},expression:"delay"}})],1)],1),t(r.Z,{staticClass:"my-4"},[t("draggable",{staticClass:"row",attrs:{group:"imageGroup"},model:{value:e.slideshow.slides,callback:function(t){e.$set(e.slideshow,"slides",t)},expression:"slideshow.slides"}},[""==e.slideshow.slides?t("p",{staticClass:"mt-6"},[e._v(" Drag images here ")]):e._l(e.slideshow.slides,(function(s){return t(n.Z,{key:s.id,attrs:{cols:"3"}},[t(o.Z,[t(l.ZB,[t($.Z,{attrs:{src:s.thumbnailUrl,contain:""}})],1),t(l.h7,[t(i.Z,{staticClass:"mt-2",attrs:{color:"warning"},on:{click:function(t){return e.removeSlide(s)}}},[e._v("Delete")])],1)],1)],1)}))],2)],1),t(A,[t(m,[t(Z,[t(U.Z,{attrs:{color:"green",dark:"",flat:""}},[t(L.qW,[e._v("Media Library")])],1)],1),t(C,[t(A,[t(m,[t(Z,[e._v("Upload an image")]),t(C,[t(D.Z,{ref:"uploadForm",attrs:{"lazy-validation":""},model:{value:e.uploadValid,callback:function(t){e.uploadValid=t},expression:"uploadValid"}},[t(I.Z,{staticClass:"mx-10",attrs:{chips:"",counter:"","show-size":"","truncate-length":"50",accept:"image/*",label:"Choose File",hint:"Recommended dimensions: 840 x 480","persistent-hint":""},model:{value:e.originalFile,callback:function(t){e.originalFile=t},expression:"originalFile"}})],1),t(i.Z,{staticClass:"justify-center",staticStyle:{display:"block",margin:"0 auto 1rem"},attrs:{right:""},on:{click:e.uploadMedia}},[e._v(" Upload ")])],1)],1),t(m,[t(Z,[e._v("Choose from media library images")]),t(C,[t(r.Z,{staticClass:"my-4"},[t("draggable",{staticClass:"row",attrs:{group:{name:"imageGroup",pull:"clone",put:"false"}},model:{value:e.images,callback:function(t){e.images=t},expression:"images"}},e._l(e.images,(function(e){return t(n.Z,{key:e.id,attrs:{cols:"3"}},[t(o.Z,[t($.Z,{attrs:{src:e.thumbnailUrl,"min-width":"150"}})],1)],1)})),1)],1),t(z.Z,{staticClass:"mt-6",attrs:{circle:"",length:e.pagesTotal,"total-visible":7},on:{input:e.getMediaLibrary},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1)],1)],1)],1)],1),t(l.h7,{staticClass:"pt-3 pb-0"},[t(i.Z,{attrs:{color:"error",to:"/terminals/slideshows"},on:{click:function(t){e.dialog=!1}}},[e._v(" Cancel ")]),t(E.Z),t(i.Z,{attrs:{color:"success"},on:{click:function(t){return e.updateSlideshow()}}},[e._v(" Update ")])],1)],1)],1)],1)],1),t(V.Z,{staticClass:"justify-center"},[t(n.Z,{attrs:{cols:"12",md:"7"}},[t(d.Z,{staticClass:"elevation-3",attrs:{headers:e.headers,items:e.slideshows,"hide-default-footer":"","disable-pagination":"",loading:e.loading,"loading-text":"Loading... Please wait"},scopedSlots:e._u([{key:"top",fn:function(){return[t(U.Z,{staticClass:"rounded-t-lg",attrs:{color:"green",dark:"",flat:""}},[t(L.qW,[e._v(" Slideshows ")]),t(E.Z),t(i.Z,{attrs:{depressed:"",light:"",to:"/add-slideshow"}},[e._v(" New Slideshow ")])],1)]},proxy:!0},{key:"item.actions",fn:function({item:s}){return[t(T.Z,{attrs:{transition:"scroll-y-transition",bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:a}){return[t(i.Z,e._g(e._b({attrs:{icon:""}},"v-btn",a,!1),s),[t(S.Z,[e._v(" mdi-dots-vertical ")])],1)]}}],null,!0)},[t(M.Z,[t(P.Z,[[t(i.Z,e._g({attrs:{color:"warning",text:""},on:{click:function(t){return e.openEditDialog(s)}}},e.on),[t(S.Z,{attrs:{small:"",left:""}},[e._v(" mdi-pencil ")]),e._v(" Edit ")],1)]],2),t(P.Z,[t(i.Z,{attrs:{color:"error",text:""},on:{click:function(t){return e.deleteSlideshow(s)}}},[t(S.Z,{attrs:{small:"",left:""}},[e._v(" mdi-delete ")]),e._v(" Delete ")],1)],1)],1)],1)]}},{key:"no-data",fn:function(){return[t(a.Z,{staticClass:"ma-2",attrs:{prominent:"",text:"",type:"info"}},[t(V.Z,{attrs:{align:"center"}},[t(n.Z,{staticClass:"grow"},[e._v(" No records found ")]),t(n.Z,{staticClass:"shrink"},[t(i.Z,{staticClass:"my-2 white--text",attrs:{color:"green"},on:{click:e.initialize}},[e._v(" Retry ")])],1)],1)],1)]},proxy:!0}],null,!0)})],1)],1)],1)},O=[],j=(s(7658),s(9669)),H=s.n(j),N=s(9980),q=s.n(N),J=s(629),W={name:"SlideshowScreen",components:{draggable:q()},data(){return{loading:!1,alert:!1,alertMessage:"",alertType:"error",dialog:!1,upload:!1,images:[],slideshows:[],slideshow:[],pagesTotal:"",page:1,name:"",delay:"",slides:[],newImage:[],id:null,headers:[{text:"Name",align:"left",value:"name",sortable:!1,filterable:!1},{text:"Actions",align:"right",value:"actions",sortable:!1,filterable:!1}]}},computed:{...(0,J.Se)(["getInternalCoreClearController"])},mounted(){this.initialize()},methods:{initialize(){this.getSlideshowList()},async openEditDialog(e){this.dialog=!0,this.getMediaLibrary();try{let t=await H().get(""+(this.getInternalCoreClearController+"/get_slide_show"),{params:{slide_show_id:e.id},withCredentials:!0,crossDomain:!0});t&&(console.log(t.data),this.slideshow=t.data)}catch(t){console.error("Could not get slideshow list"),console.error(t)}},async getSlideshowList(){try{let e=await H().get(""+(this.getInternalCoreClearController+"/slide_shows"),{withCredentials:!0,crossDomain:!0});e.data?this.slideshows=e.data.results:(this.slideshows=[],console.log("Slideshow list not found!"))}catch(e){console.error("Could not get slideshow list"),console.error(e)}},async deleteSlideshow(e){try{let t=await H().get(""+(this.getInternalCoreClearController+"/delete_slide_show"),{params:{slide_show_id:e.id},withCredentials:!0,crossDomain:!0});!0===t.data.success?(this.alert=!0,this.alertType="success",this.alertMessage="Slideshow deleted",setTimeout((()=>{location.reload()}),2e3)):(console.log(t),console.log("Slideshow not found!"))}catch(t){console.error("Could not get slideshow"),console.error(t)}},async updateSlideshow(){""==this.name&&(this.name=this.slideshow.name),""==this.delay&&(this.delay=this.slideshow.delay);let e=new FormData;e.append("name",this.name),e.append("delay",this.delay),e.append("slide_show_id",this.slideshow.id),this.slideshow.slides.forEach((t=>{e.append("slides[]",JSON.stringify(t))}));try{let t=await H().post(""+(this.getInternalCoreClearController+"/update_slide_show"),e,{withCredentials:!0,crossDomain:!0});t.data?(console.log(t),this.alert=!0,this.alertType="success",this.alertMessage="Asset updated",this.updateTerminalBrandingAsset(this.slideshow.id),setTimeout((()=>{location.reload()}),2e3)):console.log("Slideshow not found!")}catch(t){console.error("Could not get slideshow"),console.error(t)}},async uploadMedia(){let e=new FormData;e.append("upload_media",this.originalFile,this.originalFile.name);try{let t=await H().post(""+(this.getInternalCoreClearController+"/upload_media"),e,{withCredentials:!0,crossDomain:!0,headers:{"Content-Type":"multipart/form-data"}});t.data?(console.log(t.data),console.log(t.data.id),console.log(this.slideshow.slides),this.getMediaAsset(t.data.id),console.log(this.newImage)):console.log("Unable to upload")}catch(t){console.error("Could not upload media"),console.error(t)}},async getMediaLibrary(e){try{let t=await H().get(""+(this.getInternalCoreClearController+"/get_media"),{params:{page:e},withCredentials:!0,crossDomain:!0});t.data?(this.pagesTotal=t.data.pages,console.log(t.data),this.images=t.data.results):(this.images=[],console.log("Media library not found!"))}catch(t){console.error("Could not get media library"),console.error(t)}},async getMediaAsset(e){try{let t=await H().get(""+(this.getInternalCoreClearController+"/get_media_asset"),{params:{media_id:e},withCredentials:!0,crossDomain:!0});t.data?(console.log(t.data),this.newImage={description:t.data.description||"",fileUrl:t.data.fileUrl,id:t.data.id,name:t.data.name||"",originalFile:t.data.originalFile,tags:t.data.tags||null,thumbnailUrl:t.data.thumbnailUrl,video:t.data.video||!1},this.slideshow.slides.push(this.newImage)):console.log("Media asset not found!")}catch(t){console.error("Could not get media library"),console.error(t)}},removeSlide(e){const t=e.mediaId,s=this.slideshow.slides.findIndex((e=>e.mediaId===t));-1!==s&&this.slideshow.slides.splice(s,1),console.log(this.slideshow.slides)},async updateTerminalBrandingAsset(e){let t=new FormData;t.append("slide_show_id",e);try{let e=await H().post(""+(this.getInternalCoreClearController+"/update_branding_asset"),t,{withCredentials:!0,crossDomain:!0,headers:{"Content-Type":"multipart/form-data"}});console.log(e),!0===e.data.success&&console.log(e.data)}catch(s){console.error("Could not update"),console.error(s)}}}},G=W,K=s(1001),Q=(0,K.Z)(G,R,O,!1,null,null,null),X=Q.exports},6904:(e,t,s)=>{s(6699),s(7658);var a=s(4987),i=s(4609),o=s(380);t.Z=(0,a.Z)(i.Z,(0,o.J)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),s={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?s.shouldValidate=e.$watch("shouldValidate",(a=>{a&&(this.errorBag.hasOwnProperty(e._uid)||(s.valid=t(e)))})):s.valid=t(e),s},validate(){return 0===this.inputs.filter((e=>!e.validate(!0))).length},reset(){this.inputs.forEach((e=>e.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((e=>e.resetValidation())),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const s=this.watchers.find((e=>e._uid===t._uid));s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})}}]);
//# sourceMappingURL=slideshows.20699e6c.js.map