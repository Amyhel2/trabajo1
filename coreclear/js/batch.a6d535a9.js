"use strict";(self["webpackChunkcoreclear_portal"]=self["webpackChunkcoreclear_portal"]||[]).push([[251],{2152:(t,e,a)=>{a.d(e,{Z:()=>d});var n=a(5057),i=a(3432),s=function(){var t=this,e=t._self._c;return e(i.Z,{attrs:{color:t.color,bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:i}){return[e(n.Z,t._g(t._b({attrs:{color:t.color}},"v-icon",i,!1),a),[t._v(t._s(t.icon))])]}}])},[e("span",[t._v(t._s(t.message))])])},o=[],r={name:"BoolStatus",props:{status:{type:Boolean,required:!0,default:!1},statusMessage:{type:String,required:!1,default:"Approved"}},computed:{icon(){return this.status?"mdi-checkbox-marked-circle":"mdi-close"},color(){return this.status?"success":"error"},message(){return this.statusMessage.length>0?this.statusMessage:this.status?"Approved":"Unknown Error"}}},l=r,c=a(1001),h=(0,c.Z)(l,s,o,!1,null,null,null),d=h.exports},501:(t,e,a)=>{a.r(e),a.d(e,{default:()=>I});var n=a(2202),i=a(7179),s=a(3385),o=a(5223),r=a(4437),l=a(9841),c=a(7345),h=a(9789),d=a(4192),u=a(92),p=a(5294),m=a(5234),g=a(5952),f=a(5838),v=a(2370),_=function(){var t=this,e=t._self._c;return e(p.Z,{staticClass:"justify-center"},[e(r.Z,{attrs:{cols:"12",md:"10"}},[e(n.Z,{attrs:{type:t.alertType,border:"left","close-text":"Close Alert",dismissible:"",transition:"scale-transition"},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[t._v(" "+t._s(t.alertMessage)+" ")]),e(h.Z,{attrs:{width:"500"},model:{value:t.dialogDetail,callback:function(e){t.dialogDetail=e},expression:"dialogDetail"}},[e(s.Z,[e(o.EB,{staticClass:"text-h5"},[t._v(" Totals")]),e(o.ZB,{staticClass:"pb-1"},[t._v(" Captured Amount: "+t._s(t._f("currency")(t.batchDetail.capturedAmount))+" ")]),e(o.ZB,{staticClass:"pb-1"},[t._v(" Terminal Transaction Count: "+t._s(t.batchDetail.transactionCount)+" ")]),0!=t.batchDetail.transactionstotal_non_terminal_transactions?e(o.ZB,{staticClass:"pb-1"},[t._v(" Non Terminal Transaction Count: "+t._s(t.batchDetail.transactionstotal_non_terminal_transactions)+" ")]):t._e(),e(o.ZB,{staticClass:"pb-3"},[t._v(" Captured Deposit Amount: "+t._s(t._f("currency")(t.batchDetail.expectedDeposit))+" ")]),t.batchDetailVolumeByTerminalLength>0?e(o.ZB,{staticClass:"text-h5 pb-2"},[t._v(" Per Register ")]):t._e(),t._l(t.batchDetailVolumeByTerminalLength,(function(a){return e(o.ZB,{key:a,staticClass:"pb-1"},[t._v(" Terminal Name: "+t._s(t.batchDetail.volumeByTerminal[a-1].terminalName)+" "),e("br"),t._v(" Captured Amount: "+t._s(t.batchDetail.volumeByTerminal[a-1].capturedAmount)+" "),e("br"),t._v(" Transaction Count: "+t._s(t.batchDetail.volumeByTerminal[a-1].transactionCount)+" "),e("br"),e("br")])})),e(d.Z),e(o.h7,[e(m.Z),e(i.Z,{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogDetail=!1}}},[t._v(" OK ")])],1)],2)],1),e(l.Z,{staticClass:"elevation-4 rounded-lg",attrs:{"footer-props":t.tableFooterProps,headers:t.headers,items:t.batches,loading:t.loading,search:t.search,"item-key":"batchId","loading-text":"Loading... Please wait","show-expand":"","single-expand":"","sort-by":"openDate","sort-desc":""},on:{"item-expanded":t.getTransactionsForBatch},scopedSlots:t._u([{key:"item.capturedAmount",fn:function({item:a}){return[e("div",{class:a.capturedAmount<0?"red--text font-weight-bold":""},[t._v(" "+t._s(t._f("currency")(a.capturedAmount))+" ")])]}},{key:"item.open",fn:function({item:e}){return[t._v(" "+t._s(e.open?"Open":"Closed")+" ")]}},{key:"item.openDate",fn:function({item:e}){return[t._v(" "+t._s(t.formatDateTime(e.openDate))+" ")]}},{key:"item.closeDate",fn:function({item:e}){return[t._v(" "+t._s(t.formatDateTime(e.closeDate))+" ")]}},{key:"item.details",fn:function({item:a}){return[e(i.Z,{staticClass:"white--text",attrs:{color:"teal"},on:{click:function(e){return t.batchDetails(a.batchId)}}},[t._v(" Details ")])]}},{key:"item.excelExport",fn:function({item:a}){return[e(i.Z,{staticClass:"white--text",attrs:{href:t.getInternalCoreClearController+"/excel_export_batch_history/"+a.batchId,color:"green"}},[t._v(" Excel Export ")])]}},{key:"expanded-item",fn:function({headers:a,item:n}){return[e("td",{attrs:{colspan:a.length}},[e(l.Z,{staticClass:"elevation-0 ma-2",attrs:{"footer-props":t.tableFooterProps,headers:t.transactionHeaders,items:n.transactions,loading:t.transactionLoading,dense:"","item-key":"transactionId","loading-text":"Loading... Please wait","sort-by":"timestamp","sort-desc":""},scopedSlots:t._u([{key:"item.timestamp",fn:function({item:e}){return[t._v(" "+t._s(t.formatDateTime(e.timestamp))+" ")]}},{key:"item.sale_id",fn:function({item:a}){return[null!=a.receipt_link?[e(i.Z,{staticClass:"white--text",attrs:{color:"primary",href:a.receipt_link,target:"_blank"}},[t._v(" "+t._s(a.sale_id)+" ")])]:null!=a.sale_id?[t._v(" "+t._s(a.sale_id)+" ")]:[t._v(" N/A ")]]}},{key:"item.approved",fn:function({item:t}){return[e("bool-status",{attrs:{status:t.approved,"status-message":t.responseDescription}})]}},{key:"item.authorizedAmount",fn:function({item:a}){return[e("div",{class:"void"===a.transactionType||"refund"===a.transactionType||"reverse"===a.transactionType?"red--text font-weight-bold":""},[t._v(" "+t._s(t._f("currency")(a.authorizedAmount,a.transactionType))+" ")])]}},{key:"item.transactionType",fn:function({item:e}){return[t._v(" "+t._s(t._f("titleCase")(e.transactionType))+" ")]}},{key:"item.entryMethod",fn:function({item:e}){return[t._v(" "+t._s(t._f("titleCase")(e.entryMethod))+" ")]}},{key:"item.paymentType",fn:function({item:e}){return[t._v(" "+t._s(t._f("titleCase")(e.paymentType))+" ")]}}],null,!0)})],1)]}},{key:"top",fn:function(){return[e(f.Z,{staticClass:"rounded-t-lg",attrs:{color:"green darken-2",dark:"",flat:""}},[e(v.qW,[t._v("Batches")]),e(d.Z,{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),e(g.Z,{attrs:{"append-icon":"search",clearable:"",dark:"","hide-details":"",label:"Search","single-line":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e(d.Z,{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),e(u.Z,{attrs:{"close-on-content-click":!1,"nudge-right":40,"min-width":"auto","offset-y":"",transition:"scale-transition"},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:n}){return[e(g.Z,t._g(t._b({attrs:{"append-icon":"mdi-calendar","hide-details":"",label:"Date Range",readonly:"","single-line":""},model:{value:t.dateRangeText,callback:function(e){t.dateRangeText=e},expression:"dateRangeText"}},"v-text-field",n,!1),a))]}}]),model:{value:t.datePickerMenu,callback:function(e){t.datePickerMenu=e},expression:"datePickerMenu"}},[e(c.Z,{attrs:{range:""},on:{change:t.initialize},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1)]},proxy:!0},{key:"no-data",fn:function(){return[e(n.Z,{staticClass:"ma-2",attrs:{prominent:"",text:"",type:"info"}},[e(p.Z,{attrs:{align:"center"}},[e(r.Z,{staticClass:"grow"},[t._v(" No records found")]),e(r.Z,{staticClass:"shrink"},[e(i.Z,{staticClass:"my-2 white--text",attrs:{color:"green"},on:{click:t.initialize}},[t._v(" Retry ")])],1)],1)],1)]},proxy:!0}],null,!0)},[t._v(" > ")])],1)],1)},y=[],b=a(743),x=a.n(b),C=a(9669),D=a.n(C),T=a(381),k=a.n(T),Z=a(629),A=a(2152),w={name:"BatchList",components:{BoolStatus:A.Z},data(){return{dialogDetail:!1,batchDetail:{},batchDetailVolumeByTerminalLength:0,datePickerMenu:!1,loading:!1,transactionLoading:!1,alert:!1,alertMessage:"",alertType:"success",search:"",filterType:null,tableFooterProps:{showFirstLastPage:!0},headers:[{text:"Batch ID",align:"left",value:"batchId"},{text:"Amount",align:"right",value:"capturedAmount"},{text:"Status",align:"left",value:"open"},{text:"Start Date",align:"left",value:"openDate"},{text:"End Date",align:"left",value:"closeDate"},{text:"Details",align:"left",value:"details",sortable:!1,filterable:!1},{text:"Excel Export",align:"left",value:"excelExport",sortable:!1,filterable:!1}],batches:[],transactionHeaders:[{text:"Date",align:"left",value:"timestamp"},{text:"Sale ID",align:"left",value:"sale_id"},{text:"Transaction ID",align:"left",value:"transactionId"},{text:"Approved",align:"left",value:"approved"},{text:"Card Holder",align:"left",value:"cardHolder"},{text:"Amount",align:"right",value:"authorizedAmount"},{text:"Transaction Type",align:"center",value:"transactionType"},{text:"Entry Method",align:"left",value:"entryMethod"},{text:"Payment Type",align:"left",value:"paymentType"},{text:"Masked Card",align:"left",value:"maskedPan"}],dateRange:[k()().subtract(30,"days").toISOString(),k()().toISOString()]}},computed:{...(0,Z.Se)(["getInternalCoreClearController"]),dateRangeText(){return this.dateRange.map((t=>k()(t).format("MM/DD/YYYY"))).join(" through ")}},mounted(){this.initialize()},methods:{openAlert(t,e){this.alertType=t,this.alertMessage=e,this.alert=!0},async initialize(){this.loading=!0,this.datePickerMenu=!1;const t=void 0!==this.dateRange[0]?this.dateRange[0]:"",e=void 0!==this.dateRange[1]?this.dateRange[1]:"";try{let a=await D().get(""+(this.getInternalCoreClearController+"/batches/1"),{withCredentials:!0,crossDomain:!0,params:{start_date:k()(t).format("MM/DD/YYYY"),end_date:k()(e).format("MM/DD/YYYY")}});this.loading=!1,a.data.batches?this.batches=a.data.batches:(console.log("No batches found"),this.batches=[])}catch(a){console.error("Could not get list of batches"),console.error(a),this.openAlert("error",a.toString()),this.loading=!1,this.batches=[]}},async getTransactionsForBatch({item:t,value:e}){if(e){this.transactionLoading=!0;try{let e=await D().get(""+(this.getInternalCoreClearController+"/get_transactions_for_batch/1"),{withCredentials:!0,crossDomain:!0,params:{batch_id:t.batchId}});this.transactionLoading=!1,e.data?t.transactions=e.data:console.log("No transactions found")}catch(a){console.error("Could not get list of transactions"),console.error(a)}}},formatDateTime(t){return t?k()(t).format("MM/DD/YYYY LT"):""},async batchDetails(t){let e=await D().get(""+(this.getInternalCoreClearController+"/batch_details/1"),{withCredentials:!0,crossDomain:!0,params:{batch_id:t}});if(e.data){this.batchDetail=e.data,this.batchDetailVolumeByTerminalLength=e.data.volumeByTerminal.length;var a=0;if(e.data.volumeByTerminal.length)for(var n=0;n<e.data.volumeByTerminal.length;n++){var i=e.data.volumeByTerminal[n];a+=i.transactionCount}else a=e.data.transactionCount;this.batchDetail.transactionstotal_non_terminal_transactions=e.data.transactionCount-a}else console.log("No details found");this.dialogDetail=!0}},filters:{titleCase:t=>{if(!t)return"";t=t.toString().toLowerCase().split(" ");for(let e=0;e<t.length;e++)t[e]=t[e][0].toUpperCase()+t[e].slice(1);return t.join(" ")},currency:(t,e)=>{if(!t)return"0";let a=x().formatMoney(t.replace("-",""));return t<0||"void"===e||"refund"===e||"reverse"===e?"-"+a:a}}},B=w,M=a(1001),S=(0,M.Z)(B,_,y,!1,null,null,null),I=S.exports},1981:(t,e,a)=>{a.r(e),a.d(e,{default:()=>h});var n=a(6035),i=function(){var t=this,e=t._self._c;return e(n.Z,{staticClass:"py-10",attrs:{fluid:""}},[e("router-view")],1)},s=[],o={name:"BatchScreen"},r=o,l=a(1001),c=(0,l.Z)(r,i,s,!1,null,null,null),h=c.exports},3432:(t,e,a)=>{a.d(e,{Z:()=>d});var n=a(5840),i=a(8914),s=a(4019),o=a(2524),r=a(7482),l=a(1050),c=a(6596),h=a(4987),d=(0,h.Z)(i.Z,s.Z,o.Z,r.Z).extend({name:"v-tooltip",props:{closeDelay:{type:[Number,String],default:0},disabled:Boolean,openDelay:{type:[Number,String],default:0},openOnHover:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!0},tag:{type:String,default:"span"},transition:String},data:()=>({calculatedMinWidth:0,closeDependents:!1}),computed:{calculatedLeft(){const{activator:t,content:e}=this.dimensions,a=!this.bottom&&!this.left&&!this.top&&!this.right,n=!1!==this.attach?t.offsetLeft:t.left;let i=0;return this.top||this.bottom||a?i=n+t.width/2-e.width/2:(this.left||this.right)&&(i=n+(this.right?t.width:-e.width)+(this.right?10:-10)),this.nudgeLeft&&(i-=parseInt(this.nudgeLeft)),this.nudgeRight&&(i+=parseInt(this.nudgeRight)),`${this.calcXOverflow(i,this.dimensions.content.width)}px`},calculatedTop(){const{activator:t,content:e}=this.dimensions,a=!1!==this.attach?t.offsetTop:t.top;let n=0;return this.top||this.bottom?n=a+(this.bottom?t.height:-e.height)+(this.bottom?10:-10):(this.left||this.right)&&(n=a+t.height/2-e.height/2),this.nudgeTop&&(n-=parseInt(this.nudgeTop)),this.nudgeBottom&&(n+=parseInt(this.nudgeBottom)),!1===this.attach&&(n+=this.pageYOffset),`${this.calcYOverflow(n)}px`},classes(){return{"v-tooltip--top":this.top,"v-tooltip--right":this.right,"v-tooltip--bottom":this.bottom,"v-tooltip--left":this.left,"v-tooltip--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},computedTransition(){return this.transition?this.transition:this.isActive?"scale-transition":"fade-transition"},offsetY(){return this.top||this.bottom},offsetX(){return this.left||this.right},styles(){return{left:this.calculatedLeft,maxWidth:(0,l.kb)(this.maxWidth),minWidth:(0,l.kb)(this.minWidth),top:this.calculatedTop,zIndex:this.zIndex||this.activeZIndex}}},beforeMount(){this.$nextTick((()=>{this.value&&this.callActivate()}))},mounted(){"v-slot"===(0,l.sp)(this,"activator",!0)&&(0,c.N6)("v-tooltip's activator slot must be bound, try '<template #activator=\"data\"><v-btn v-on=\"data.on>'",this)},methods:{activate(){this.updateDimensions(),requestAnimationFrame(this.startTransition)},deactivate(){this.runDelay("close")},genActivatorListeners(){const t=n.Z.options.methods.genActivatorListeners.call(this);return this.openOnFocus&&(t.focus=t=>{this.getActivator(t),this.runDelay("open")},t.blur=t=>{this.getActivator(t),this.runDelay("close")}),t.keydown=t=>{t.keyCode===l.Do.esc&&(this.getActivator(t),this.runDelay("close"))},t},genActivatorAttributes(){return{"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genTransition(){const t=this.genContent();return this.computedTransition?this.$createElement("transition",{props:{name:this.computedTransition}},[t]):t},genContent(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-tooltip__content",class:{[this.contentClass]:!0,menuable__content__active:this.isActive,"v-tooltip__content--fixed":this.activatorFixed},style:this.styles,attrs:this.getScopeIdAttrs(),directives:[{name:"show",value:this.isContentActive}],ref:"content"}),this.getContentSlot())}},render(t){return t(this.tag,{staticClass:"v-tooltip",class:this.classes},[this.showLazyContent((()=>[this.genTransition()])),this.genActivator()])}})}}]);
//# sourceMappingURL=batch.a6d535a9.js.map